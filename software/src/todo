- refactor the long function
- add comments
